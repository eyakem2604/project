<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Earn Ethiopia</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <header>
    <h1>Admin Panel</h1>
    <button onclick="window.location.href='dashboard.html'">Back to Dashboard</button>
  </header>

  <section>
    <h2>Add Task</h2>
    <input type="text" id="taskTitle" placeholder="Title">
    <input type="text" id="taskLink" placeholder="Link">
    <input type="number" id="taskReward" placeholder="Reward Points">
    <button id="addTaskBtn">Add Task</button>
  </section>

  <section>
    <h2>Add Announcement</h2>
    <textarea id="announcementContent" placeholder="Content"></textarea>
    <button id="addAnnouncementBtn">Add Announcement</button>
  </section>

  <section>
    <h2>Submissions</h2>
    <div id="submissions"></div>
  </section>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script src="app.js"></script>
<script>
window.addEventListener('load', async () => {
  const user = supabase.auth.user();
  if (!user || user.email !== "eyakemabi@gmail.com") {
    alert("Access denied");
    window.location.href = "dashboard.html";
  } else {
    loadSubmissions();
  }
});

document.getElementById('addTaskBtn').addEventListener('click', async () => {
  const title = document.getElementById('taskTitle').value;
  const link = document.getElementById('taskLink').value;
  const reward = Number(document.getElementById('taskReward').value);
  await adminAddTask(title, link, reward);
});

document.getElementById('addAnnouncementBtn').addEventListener('click', async () => {
  const content = document.getElementById('announcementContent').value;
  await adminAddAnnouncement(content);
});
</script>
</body>
</html>