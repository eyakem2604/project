<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallet - Earn Ethiopia</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <header>
    <h1>Wallet</h1>
    <p>Total Points: <span id="points">0</span></p>
    <button onclick="window.location.href='dashboard.html'">Back to Dashboard</button>
  </header>

  <form id="withdrawForm">
    <input type="text" id="telebirrName" placeholder="Telebirr Name" required>
    <input type="text" id="telebirrNumber" placeholder="Telebirr Number" required>
    <button type="submit">Withdraw</button>
  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script src="app.js"></script>
<script>
async function loadWallet() {
  const user = supabase.auth.user();
  if (!user) return window.location.href = 'login.html';
  const { data: userData } = await supabase.from('users').select('*').eq('id', user.id).single();
  document.getElementById('points').innerText = userData.points;
}
window.addEventListener('load', loadWallet);

document.getElementById('withdrawForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const name = document.getElementById('telebirrName').value;
  const number = document.getElementById('telebirrNumber').value;
  await requestWithdrawal(name, number);
});
</script>
</body>
</html>